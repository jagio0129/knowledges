なるほどUnixプロセス
===

## fork

### 特徴

- 実行中のプロセスから新しいプロセスをコピーできる
- forkを呼ぶ側が親。新しく作成される方が子
- 親のメモリはすべて子にコピーされる。
- 親が開いているファイルディスクリプタも共有される。
- CoWという仕組みにより、書き込みが発生するまではメモリはコピーされない。

### 孤児プロセス

- 子プロセスは端末からの制御が効かない
- 親プロセスが死んでも子プロセスは死なない
- 孤児プロセスを管理するには以下の方法
  - デーモンプロセス
  - Unixシグナル

### CoW(コピーオンライト)

- forkすると親プロセスのメモリのすべてが子プロセスにコピーされる
- ただ、全てを一度にコピーするのは物理的オーバーヘッドが大きい
- Unixで書き込みが必要になるまでコピーを遅らせる(CoW)
- Ruby2.0以上はCoWフレンドリーだが、1.9以下はCoWが考慮されていない仕様になっている
